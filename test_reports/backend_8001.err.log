INFO:     Started server process [29812]
INFO:     Waiting for application startup.
2026-02-05 17:49:19,535 - passlib.handlers.bcrypt - WARNING - (trapped) error reading bcrypt version
Traceback (most recent call last):
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\passlib\handlers\bcrypt.py", line 620, in _load_backend_mixin
    version = _bcrypt.__about__.__version__
              ^^^^^^^^^^^^^^^^^
AttributeError: module 'bcrypt' has no attribute '__about__'
INFO:     Application startup complete.
INFO:     Uvicorn running on http://0.0.0.0:8001 (Press CTRL+C to quit)
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 118, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 314, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\OneDrive\Documenti\GitHub\GESTIONALENUOVO\backend\server.py", line 1669, in get_product_by_barcode
    async for p in cursor:
    ...<2 lines>...
            break
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\motor\core.py", line 1390, in next
    if self.alive and (self._buffer_size() or await self._get_more()):
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\cursor.py", line 1179, in _refresh
    self.__send_message(q)
    ~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\cursor.py", line 1060, in __send_message
    response = client._run_operation(
        operation, self._unpack_response, address=self.__address
    )
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1388, in _run_operation
    return self._retryable_read(
           ~~~~~~~~~~~~~~~~~~~~^
        _cmd,
        ^^^^^
    ...<3 lines>...
        retryable=isinstance(operation, message._Query),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1535, in _retryable_read
    return func(session, server, conn, read_pref)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1384, in _cmd
    return server.run_operation(
           ~~~~~~~~~~~~~~~~~~~~^
        conn, operation, read_preference, self._event_listeners, unpack_res
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\helpers.py", line 315, in inner
    return func(*args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\server.py", line 174, in run_operation
    _check_command_response(first, conn.max_wire_version)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\helpers.py", line 223, in _check_command_response
    raise OperationFailure(errmsg, code, response, max_wire_version)
pymongo.errors.OperationFailure: Cannot do exclusion on field image_base64 in inclusion projection, full error: {'ok': 0.0, 'errmsg': 'Cannot do exclusion on field image_base64 in inclusion projection', 'code': 31254, 'codeName': 'Location31254'}
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\cors.py", line 85, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 118, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 314, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\OneDrive\Documenti\GitHub\GESTIONALENUOVO\backend\server.py", line 1669, in get_product_by_barcode
    async for p in cursor:
    ...<2 lines>...
            break
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\motor\core.py", line 1390, in next
    if self.alive and (self._buffer_size() or await self._get_more()):
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\cursor.py", line 1179, in _refresh
    self.__send_message(q)
    ~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\cursor.py", line 1060, in __send_message
    response = client._run_operation(
        operation, self._unpack_response, address=self.__address
    )
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1388, in _run_operation
    return self._retryable_read(
           ~~~~~~~~~~~~~~~~~~~~^
        _cmd,
        ^^^^^
    ...<3 lines>...
        retryable=isinstance(operation, message._Query),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1535, in _retryable_read
    return func(session, server, conn, read_pref)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1384, in _cmd
    return server.run_operation(
           ~~~~~~~~~~~~~~~~~~~~^
        conn, operation, read_preference, self._event_listeners, unpack_res
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\helpers.py", line 315, in inner
    return func(*args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\server.py", line 174, in run_operation
    _check_command_response(first, conn.max_wire_version)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\helpers.py", line 223, in _check_command_response
    raise OperationFailure(errmsg, code, response, max_wire_version)
pymongo.errors.OperationFailure: Cannot do exclusion on field image_base64 in inclusion projection, full error: {'ok': 0.0, 'errmsg': 'Cannot do exclusion on field image_base64 in inclusion projection', 'code': 31254, 'codeName': 'Location31254'}
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\cors.py", line 148, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 118, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 314, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\OneDrive\Documenti\GitHub\GESTIONALENUOVO\backend\server.py", line 1669, in get_product_by_barcode
    async for p in cursor:
    ...<2 lines>...
            break
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\motor\core.py", line 1390, in next
    if self.alive and (self._buffer_size() or await self._get_more()):
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\cursor.py", line 1179, in _refresh
    self.__send_message(q)
    ~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\cursor.py", line 1060, in __send_message
    response = client._run_operation(
        operation, self._unpack_response, address=self.__address
    )
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1388, in _run_operation
    return self._retryable_read(
           ~~~~~~~~~~~~~~~~~~~~^
        _cmd,
        ^^^^^
    ...<3 lines>...
        retryable=isinstance(operation, message._Query),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1535, in _retryable_read
    return func(session, server, conn, read_pref)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1384, in _cmd
    return server.run_operation(
           ~~~~~~~~~~~~~~~~~~~~^
        conn, operation, read_preference, self._event_listeners, unpack_res
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\helpers.py", line 315, in inner
    return func(*args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\server.py", line 174, in run_operation
    _check_command_response(first, conn.max_wire_version)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\helpers.py", line 223, in _check_command_response
    raise OperationFailure(errmsg, code, response, max_wire_version)
pymongo.errors.OperationFailure: Cannot do exclusion on field image_base64 in inclusion projection, full error: {'ok': 0.0, 'errmsg': 'Cannot do exclusion on field image_base64 in inclusion projection', 'code': 31254, 'codeName': 'Location31254'}
2026-02-05 17:54:33,693 - asyncio - ERROR - Exception in callback _ProactorBasePipeTransport._call_connection_lost()
handle: <Handle _ProactorBasePipeTransport._call_connection_lost()>
Traceback (most recent call last):
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\asyncio\events.py", line 89, in _run
    self._context.run(self._callback, *self._args)
    ~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\asyncio\proactor_events.py", line 165, in _call_connection_lost
    self._sock.shutdown(socket.SHUT_RDWR)
    ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^
ConnectionResetError: [WinError 10054] Connessione in corso interrotta forzatamente dall'host remoto
ERROR:    Exception in ASGI application
Traceback (most recent call last):
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\uvicorn\protocols\http\h11_impl.py", line 408, in run_asgi
    result = await app(  # type: ignore[func-returns-value]
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
        self.scope, self.receive, self.send
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\uvicorn\middleware\proxy_headers.py", line 84, in __call__
    return await self.app(scope, receive, send)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\applications.py", line 1135, in __call__
    await super().__call__(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\applications.py", line 123, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\errors.py", line 186, in __call__
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\errors.py", line 164, in __call__
    await self.app(scope, receive, _send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\cors.py", line 93, in __call__
    await self.simple_response(scope, receive, send, request_headers=headers)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\cors.py", line 148, in simple_response
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\middleware\exceptions.py", line 65, in __call__
    await wrap_app_handling_exceptions(self.app, conn)(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\middleware\asyncexitstack.py", line 18, in __call__
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 756, in __call__
    await self.middleware_stack(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 776, in app
    await route.handle(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\routing.py", line 297, in handle
    await self.app(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 118, in app
    await wrap_app_handling_exceptions(app, request)(scope, receive, send)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 64, in wrapped_app
    raise exc
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\starlette\_exception_handler.py", line 53, in wrapped_app
    await app(scope, receive, sender)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 104, in app
    response = await f(request)
               ^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 428, in app
    raw_response = await run_endpoint_function(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    ...<3 lines>...
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\fastapi\routing.py", line 314, in run_endpoint_function
    return await dependant.call(**values)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\OneDrive\Documenti\GitHub\GESTIONALENUOVO\backend\server.py", line 1669, in get_product_by_barcode
    async for p in cursor:
    ...<2 lines>...
            break
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\motor\core.py", line 1390, in next
    if self.alive and (self._buffer_size() or await self._get_more()):
                                              ^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\concurrent\futures\thread.py", line 59, in run
    result = self.fn(*self.args, **self.kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\cursor.py", line 1179, in _refresh
    self.__send_message(q)
    ~~~~~~~~~~~~~~~~~~~^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\cursor.py", line 1060, in __send_message
    response = client._run_operation(
        operation, self._unpack_response, address=self.__address
    )
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1388, in _run_operation
    return self._retryable_read(
           ~~~~~~~~~~~~~~~~~~~~^
        _cmd,
        ^^^^^
    ...<3 lines>...
        retryable=isinstance(operation, message._Query),
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\_csot.py", line 108, in csot_wrapper
    return func(self, *args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1535, in _retryable_read
    return func(session, server, conn, read_pref)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\mongo_client.py", line 1384, in _cmd
    return server.run_operation(
           ~~~~~~~~~~~~~~~~~~~~^
        conn, operation, read_preference, self._event_listeners, unpack_res
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\helpers.py", line 315, in inner
    return func(*args, **kwargs)
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\server.py", line 174, in run_operation
    _check_command_response(first, conn.max_wire_version)
    ~~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\jnuci\AppData\Local\Programs\Python\Python313\Lib\site-packages\pymongo\helpers.py", line 223, in _check_command_response
    raise OperationFailure(errmsg, code, response, max_wire_version)
pymongo.errors.OperationFailure: Cannot do exclusion on field image_base64 in inclusion projection, full error: {'ok': 0.0, 'errmsg': 'Cannot do exclusion on field image_base64 in inclusion projection', 'code': 31254, 'codeName': 'Location31254'}
